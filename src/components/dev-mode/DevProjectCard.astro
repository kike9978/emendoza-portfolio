---
import { Image } from "astro:assets";
import type { ImageMetadata } from "astro";

const { name, description, site, repository, technologies, imagePath } =
    Astro.props;
const images = import.meta.glob<{ default: ImageMetadata }>(
    "/src/assets/dev-mode/*.{jpeg,jpg,png,gif}",
);
if (!images[imagePath])
    throw new Error(
        `"${imagePath}" does not exist in glob: "src/assets/*.{jpeg,jpg,png,gif}"`,
    );
---

<article
    class="flex flex-col relative hover:z-10 hover:-translate-y-4 transition-all items-center"
>
    <div class="absolute flex flex-col justify-center items-center h-[95%]">
        <!-- -[radial-gradient(at_center_bottom,_var(--tw-gradient-stops))] from-zinc-100 to-[transparent] -->
        <div
            class="h-[33%] md:h-[40%] w-full relative flex flex-col justify-center items-center overflow-hidden"
        >
            <div
                class="h-[80%] w-[70%] rounded-sm overflow-hidden top-1 relative shadow-[0_35px_60px_-15px_white]"
            >
                <Image
                    src={images[imagePath]()}
                    alt="holi"
                    class="object-cover relative object-top mx-auto shadow-2xl z-10"
                />
            </div>
            <svg
                width="365"
                height="189"
                viewBox="0 0 365 189"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
                class="absolute w-[95%] h-auto top-0"
            >
                <path
                    d="M182.755 189C21.1959 189 0.674308 189 0.674308 189C2.30294 111.903 6.55305 64.3204 9.73739 38.6062C11.639 23.2356 23.5464 11.0298 38.8564 8.70436C64.4933 4.81727 110.767 -7.95949e-06 182.751 -7.95945e-06C254.734 -7.95946e-06 301.08 4.82105 326.702 8.71192C341.993 11.0336 353.9 23.2129 355.813 38.5647C359.001 64.1322 364.842 189 364.842 189C364.842 189 318.684 189 182.755 189Z"
                    fill="url(#paint0_radial_687_1680)"></path>
                <defs>
                    <radialGradient
                        id="paint0_radial_687_1680"
                        cx="0"
                        cy="0"
                        r="1"
                        gradientUnits="userSpaceOnUse"
                        gradientTransform="translate(191.5 189) rotate(-90) scale(199.5 384.399)"
                    >
                        <stop offset="0.258152" stop-color="#605DFE"></stop>
                        <stop offset="1" stop-color="#4D2A7A"></stop>
                    </radialGradient>
                </defs>
            </svg>
            <svg
                width="377"
                height="196"
                viewBox="0 0 377 196"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
                class="absolute z-20 top-0 w-full h-auto"
            >
                <path
                    d="M6.67431 195C8.30294 117.903 12.553 70.3204 15.7374 44.6062C17.639 29.2356 29.5464 17.0298 44.8564 14.7044C70.4933 10.8173 116.767 5.99999 188.751 5.99999C260.734 5.99999 307.08 10.8211 332.702 14.7119C347.993 17.0336 359.9 29.2129 361.813 44.5647C365.001 70.1322 370.842 195 370.842 195"
                    stroke="black"
                    stroke-width="8"></path>
            </svg>
        </div>
        <div
            class="py-4 flex flex-col flex-grow items-center top-16 md:top-7 w-[82%]"
        >
            <div class="gap-6 flex flex-col flex-grow">
                <div class="gap-3 flex flex-col">
                    <h2 class="font-heading font-bold text-2xl">{name}</h2>
                    <p>{description}</p>
                </div>
                <div class="flex gap-2 flex-wrap w-full">
                    {
                        technologies.map((techonology) => {
                            return (
                                <div>
                                    <span class="rounded-xl px-2 py-1 bg-slate-100 text-slate-500">
                                        {techonology}
                                    </span>
                                </div>
                            );
                        })
                    }
                </div>
            </div>
            <div
                class="flex gap-1 justify-between items-center font-bold w-full"
            >
                {
                    site && (
                        <a
                            title="Live site"
                            class="rounded-md  flex justify-center text-blue-500 hover:text-blue-600 gap-1"
                            href={site}
                            target="_blank"
                        >
                            <span class="material-symbols-outlined">
                                language
                            </span>
                            <span>Live site</span>
                        </a>
                    )
                }
                {
                    repository && (
                        <a
                            title="Code repository"
                            class="font-bold text-blue-500 hover:text-blue-600 flex justify-center gap-1"
                            href={repository}
                            target="_blank"
                        >
                            <span class="material-symbols-outlined">code</span>
                            <span>Code base</span>
                        </a>
                    )
                }
            </div>
        </div>
    </div>
    <svg
        width="366"
        height="512"
        viewBox="0 0 366 512"
        fill="white"
        xmlns="http://www.w3.org/2000/svg"
        class="-z-10 max-w-72 h-auto md:max-w-auto"
    >
        <path
            d="M325.927 498.024L325.926 498.024C299.452 501.931 251.788 507 182.755 507C113.721 507 66.1248 501.939 39.639 498.032L39.6386 498.032C26.3912 496.08 16.0718 485.529 14.4334 472.246C10.447 439.904 4.77031 373.26 4.77031 255.886C4.77032 138.512 10.4812 71.4123 14.4712 39.1924L14.4713 39.1919C16.1096 25.9492 26.3697 15.4256 39.5727 13.4202C64.9472 9.573 110.98 4.76994 182.751 4.76994C254.523 4.76994 300.628 9.57698 325.986 13.4278L325.986 13.4278C339.174 15.4302 349.432 25.9316 351.08 39.1546L351.08 39.1548C355.066 71.1204 360.731 137.398 360.731 255.886C360.731 324.977 354.172 447.542 351.229 473.209C349.345 486.459 339.314 496.052 325.927 498.024Z"
            fill="white"
            stroke="black"
            stroke-width="9.5399"></path>
    </svg>
</article>

<style>
    .hover {
        rotate: 0deg !important;
    }

    .stroke {
        -webkit-text-stroke: 10px black;
    }
    @media (prefers-color-scheme: dark) {
        .stroke {
            filter: invert();
        }
    }
</style>

<script>
    const article = document.querySelectorAll("article");
    function getRandomDegs() {
        const deg = Math.random() * 8;
        const extendedRange = deg - 4;
        return extendedRange.toFixed(2) + "deg";
    }

    article.forEach((article) => {
        article.style.rotate = getRandomDegs();
        article.addEventListener("mouseenter", () => {
            article.classList.add("hover");
        });
        article.addEventListener("mouseleave", () => {
            article.classList.remove("hover");
        });
    });
</script>
